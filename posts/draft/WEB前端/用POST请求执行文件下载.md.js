webpackJsonp([111],{621:function(n,s){n.exports={content:["article",["p","\u7f51\u9875\u4e0a\u901a\u5e38\u7528GET\u8bf7\u6c42\u6253\u5f00\u4e00\u4e2a\u65b0\u9875\u9762\u53d1\u8d77\u4e00\u4e2a\u6587\u4ef6\u4e0b\u8f7d\uff0c\u4f46\u6709\u65f6\u5019\u9700\u8981\u5bf9\u8bf7\u6c42\u5934\u8fdb\u884c\u989d\u5916\u4f20\u53c2\uff0c\u6216\u8005\u8bf7\u6c42\u53c2\u6570\u5f88\u4e30\u5bcc\uff0c\u9700\u8981\u624b\u5de5\u53d1\u8d77\u8bf7\u6c42\uff0c\u6b64\u65f6\u9700\u8981\u5904\u7406\u670d\u52a1\u8fd4\u56de\u7684\u6d41\u6570\u636e\uff0c\u5728\u524d\u7aef\u7ec4\u88c5\u6210\u6587\u4ef6\uff0c\u518d\u8fdb\u884c\u4e0b\u8f7d\u3002"],["pre",{lang:null,highlighted:'function <span class="token function">downloadUseATag</span><span class="token punctuation">(</span>url<span class="token punctuation">,</span> fileName <span class="token operator">=</span> <span class="token string">\'\u672a\u547d\u540d\'</span><span class="token punctuation">)</span> {\n  <span class="token keyword">const</span> link <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">\'a\'</span><span class="token punctuation">)</span>\n  link<span class="token punctuation">.</span>style<span class="token punctuation">.</span>display <span class="token operator">=</span> <span class="token string">\'none\'</span>\n  link<span class="token punctuation">.</span>href <span class="token operator">=</span> url\n  link<span class="token punctuation">.</span><span class="token function">setAttribute</span><span class="token punctuation">(</span><span class="token string">\'download\'</span><span class="token punctuation">,</span> fileName<span class="token punctuation">)</span>\n\n  <span class="token keyword">const</span> <span class="token variable">$body</span> <span class="token operator">=</span> document<span class="token punctuation">.</span>body\n  <span class="token variable">$body</span><span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>link<span class="token punctuation">)</span>\n  link<span class="token punctuation">.</span><span class="token function">click</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n  <span class="token variable">$body</span><span class="token punctuation">.</span><span class="token function">removeChild</span><span class="token punctuation">(</span>link<span class="token punctuation">)</span>\n}\n\nasync function <span class="token function">downloadPost</span><span class="token punctuation">(</span>url<span class="token punctuation">,</span> { requestParams<span class="token punctuation">,</span> fileType <span class="token operator">=</span> <span class="token string">\'application/vnd.ms-excel\'</span><span class="token punctuation">,</span> fileName <span class="token operator">=</span> <span class="token string">\'\u4e0b\u8f7d\u6587\u4ef6.xlsx\'</span> } <span class="token operator">=</span> {}<span class="token punctuation">)</span> {\n  <span class="token operator">/</span><span class="token operator">/</span> requestUtil\u662f\u6307\u8bf7\u6c42\u5de5\u5177\uff0c\u4f8b\u5982axios\u7b49\n  <span class="token keyword">const</span> data <span class="token operator">=</span> await <span class="token function">requestUtil</span><span class="token punctuation">(</span>url<span class="token punctuation">,</span> {\n    method<span class="token punctuation">:</span> <span class="token string">\'post\'</span><span class="token punctuation">,</span>\n    data<span class="token punctuation">:</span> requestParams<span class="token punctuation">,</span>\n    headers<span class="token punctuation">:</span> {\n      <span class="token string">\'content-type\'</span><span class="token punctuation">:</span> <span class="token string">\'application/json\'</span>\n    }<span class="token punctuation">,</span>\n    responseType<span class="token punctuation">:</span> <span class="token string">\'blob\'</span>\n  }<span class="token punctuation">)</span>\n  <span class="token keyword">if</span> <span class="token punctuation">(</span>!data<span class="token punctuation">)</span> {\n    return Promise<span class="token punctuation">.</span><span class="token function">reject</span><span class="token punctuation">(</span><span class="token string">\'FAIL\'</span><span class="token punctuation">)</span>\n  }\n  <span class="token keyword">if</span> <span class="token punctuation">(</span>typeof window<span class="token punctuation">.</span>navigator<span class="token punctuation">.</span>msSaveBlob !<span class="token operator">==</span> <span class="token string">\'undefined\'</span><span class="token punctuation">)</span> {\n    window<span class="token punctuation">.</span>navigator<span class="token punctuation">.</span><span class="token function">msSaveBlob</span><span class="token punctuation">(</span>new <span class="token function">Blob</span><span class="token punctuation">(</span><span class="token punctuation">[</span>data<span class="token punctuation">]</span><span class="token punctuation">,</span> { type<span class="token punctuation">:</span> fileType }<span class="token punctuation">)</span><span class="token punctuation">,</span> fileName<span class="token punctuation">)</span>\n  } <span class="token keyword">else</span> {\n    <span class="token keyword">const</span> url <span class="token operator">=</span> window<span class="token punctuation">.</span>URL<span class="token punctuation">.</span><span class="token function">createObjectURL</span><span class="token punctuation">(</span>new <span class="token function">Blob</span><span class="token punctuation">(</span><span class="token punctuation">[</span>data<span class="token punctuation">]</span><span class="token punctuation">,</span> { type<span class="token punctuation">:</span> fileType }<span class="token punctuation">)</span><span class="token punctuation">)</span>\n    <span class="token function">downloadUseATag</span><span class="token punctuation">(</span>url<span class="token punctuation">,</span> fileName<span class="token punctuation">)</span>\n    window<span class="token punctuation">.</span>URL<span class="token punctuation">.</span><span class="token function">revokeObjectURL</span><span class="token punctuation">(</span>url<span class="token punctuation">)</span> <span class="token operator">/</span><span class="token operator">/</span> \u91ca\u653e\u6389blob\u5bf9\u8c61\n  }\n  return <span class="token string">\'SUCCESS\'</span>\n}'},["code","function downloadUseATag(url, fileName = '\u672a\u547d\u540d') {\n  const link = document.createElement('a')\n  link.style.display = 'none'\n  link.href = url\n  link.setAttribute('download', fileName)\n\n  const $body = document.body\n  $body.appendChild(link)\n  link.click()\n  $body.removeChild(link)\n}\n\nasync function downloadPost(url, { requestParams, fileType = 'application/vnd.ms-excel', fileName = '\u4e0b\u8f7d\u6587\u4ef6.xlsx' } = {}) {\n  // requestUtil\u662f\u6307\u8bf7\u6c42\u5de5\u5177\uff0c\u4f8b\u5982axios\u7b49\n  const data = await requestUtil(url, {\n    method: 'post',\n    data: requestParams,\n    headers: {\n      'content-type': 'application/json'\n    },\n    responseType: 'blob'\n  })\n  if (!data) {\n    return Promise.reject('FAIL')\n  }\n  if (typeof window.navigator.msSaveBlob !== 'undefined') {\n    window.navigator.msSaveBlob(new Blob([data], { type: fileType }), fileName)\n  } else {\n    const url = window.URL.createObjectURL(new Blob([data], { type: fileType }))\n    downloadUseATag(url, fileName)\n    window.URL.revokeObjectURL(url) // \u91ca\u653e\u6389blob\u5bf9\u8c61\n  }\n  return 'SUCCESS'\n}"]]],meta:{filename:"posts/draft/WEB\u524d\u7aef/\u7528POST\u8bf7\u6c42\u6267\u884c\u6587\u4ef6\u4e0b\u8f7d.md"}}}});