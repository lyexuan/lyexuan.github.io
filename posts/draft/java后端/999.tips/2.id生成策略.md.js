webpackJsonp([86],{614:function(n,s){n.exports={content:["article",["h1","\u53c2\u8003"],["ul",["li",["p",["a",{title:null,href:"https://blog.csdn.net/qq_50446805/article/details/137152411"},"https://blog.csdn.net/qq_50446805/article/details/137152411"]]],["li",["p",["a",{title:null,href:"https://blog.csdn.net/yuanchangliang/article/details/128124568"},"https://blog.csdn.net/yuanchangliang/article/details/128124568"]]],["li",["p",["a",{title:null,href:"https://zhuanlan.zhihu.com/p/689802679"},"https://zhuanlan.zhihu.com/p/689802679"]]],["li",["p",["a",{title:null,href:"https://blog.51cto.com/u_16213449/8781117"},"https://blog.51cto.com/u_16213449/8781117"]]],["li",["p",["a",{title:null,href:"https://blog.csdn.net/prjh_/article/details/134654579"},"https://blog.csdn.net/prjh_/article/details/134654579"]]]],["h1","\u96ea\u82b1id\u751f\u6210"],["ul",["li",["p",["a",{title:null,href:"https://blog.csdn.net/prjh_/article/details/134654579"},"https://blog.csdn.net/prjh_/article/details/134654579"]]]],["pre",{lang:null,highlighted:'public class SnowFlakeUtil {\n    <span class="token operator">/</span><span class="token operator">/</span> \u8d77\u59cb\u65f6\u95f4\u6233\n    private <span class="token keyword">static</span> long startTimeStamp<span class="token comment" spellcheck="true">;</span>\n    <span class="token operator">/</span><span class="token operator">/</span> \u673a\u5668ID\n    private <span class="token keyword">static</span> long workID<span class="token comment" spellcheck="true">;</span>\n    <span class="token operator">/</span><span class="token operator">/</span> \u6570\u636e\u4e2d\u5fc3ID\n    private <span class="token keyword">static</span> long dataCenterID<span class="token comment" spellcheck="true">;</span>\n    <span class="token operator">/</span><span class="token operator">/</span> \u5e8f\u5217\u53f7\n    private <span class="token keyword">static</span> long sequence<span class="token comment" spellcheck="true">;</span>\n    <span class="token operator">/</span><span class="token operator">/</span> \u6570\u636e\u4e2d\u5fc3ID\u79fb\u52a8\u4f4d\u6570\n    private <span class="token keyword">static</span> long dataCenterIndex<span class="token comment" spellcheck="true">;</span>\n    <span class="token operator">/</span><span class="token operator">/</span> \u673a\u5668ID\u79fb\u52a8\u4f4d\u6570\n    private <span class="token keyword">static</span> long workIDIndex<span class="token comment" spellcheck="true">;</span>\n    <span class="token operator">/</span><span class="token operator">/</span> \u65f6\u95f4\u6233\u79fb\u52a8\u4f4d\u6570\n    private <span class="token keyword">static</span> long timeStampIndex<span class="token comment" spellcheck="true">;</span>\n    <span class="token operator">/</span><span class="token operator">/</span> \u8bb0\u5f55\u4e0a\u4e00\u6b21\u65f6\u95f4\u6233\n    private <span class="token keyword">static</span> long lastTimeStamp<span class="token comment" spellcheck="true">;</span>\n    <span class="token operator">/</span><span class="token operator">/</span> \u5e8f\u5217\u53f7\u63a9\u7801\n    private <span class="token keyword">static</span> long sequenceMask<span class="token comment" spellcheck="true">;</span>\n    <span class="token operator">/</span><span class="token operator">/</span> \u5e8f\u5217\u53f7\u957f\u5ea6<span class="token number">12</span>\u4f4d\n    private <span class="token keyword">static</span> long sequenceLength<span class="token comment" spellcheck="true">;</span>\n\n    <span class="token operator">/</span><span class="token operator">/</span> \u521d\u59cb\u5316\u6570\u636e\n    <span class="token keyword">static</span> {\n        startTimeStamp <span class="token operator">=</span> 1577808000000L<span class="token comment" spellcheck="true">;</span>\n        <span class="token operator">/</span><span class="token operator">/</span> \u8bbe\u7f6e\u673a\u5668\u7f16\u53f7 <span class="token number">1</span>\n        workID <span class="token operator">=</span> 1L<span class="token comment" spellcheck="true">;</span>\n        <span class="token operator">/</span><span class="token operator">/</span> \u8bbe\u7f6e\u6570\u636e\u4e2d\u5fc3ID\n        dataCenterID <span class="token operator">=</span> 1L<span class="token comment" spellcheck="true">;</span>\n        <span class="token operator">/</span><span class="token operator">/</span> \u8d77\u59cb\u5e8f\u5217\u53f7 <span class="token number">0</span>\u5f00\u59cb\n        sequence <span class="token operator">=</span> 0L<span class="token comment" spellcheck="true">;</span>\n        <span class="token operator">/</span><span class="token operator">/</span> \u6570\u636e\u4e2d\u5fc3\u4f4d\u79fb\u4f4d\u6570\n        dataCenterIndex <span class="token operator">=</span> 12L<span class="token comment" spellcheck="true">;</span>\n        <span class="token operator">/</span><span class="token operator">/</span> \u673a\u5668ID\u4f4d\u79fb\u4f4d\u6570\n        workIDIndex <span class="token operator">=</span> 17L<span class="token comment" spellcheck="true">;</span>\n        <span class="token operator">/</span><span class="token operator">/</span> \u65f6\u95f4\u6233\u4f4d\u79fb\u4f4d\u6570\n        timeStampIndex <span class="token operator">=</span> 22L<span class="token comment" spellcheck="true">;</span>\n        <span class="token operator">/</span><span class="token operator">/</span> \u8bb0\u5f55\u4e0a\u6b21\u65f6\u95f4\u6233\n        lastTimeStamp <span class="token operator">=</span> <span class="token operator">-</span>1L<span class="token comment" spellcheck="true">;</span>\n        <span class="token operator">/</span><span class="token operator">/</span> \u5e8f\u5217\u53f7\u957f\u5ea6\n        sequenceLength <span class="token operator">=</span> 12L<span class="token comment" spellcheck="true">;</span>\n        <span class="token operator">/</span><span class="token operator">/</span> \u5e8f\u5217\u53f7\u63a9\u7801\n        sequenceMask <span class="token operator">=</span> <span class="token operator">-</span>1L <span class="token operator">^</span> <span class="token punctuation">(</span><span class="token operator">-</span>1L <span class="token operator">&lt;</span><span class="token operator">&lt;</span> sequenceLength<span class="token punctuation">)</span><span class="token comment" spellcheck="true">;</span>\n    }\n\n    public synchronized <span class="token keyword">static</span> long <span class="token function">getID</span><span class="token punctuation">(</span><span class="token punctuation">)</span> {\n        <span class="token operator">/</span><span class="token operator">/</span> \u83b7\u5f97\u5f53\u524d\u65f6\u95f4\n        long now <span class="token operator">=</span> System<span class="token punctuation">.</span><span class="token function">currentTimeMillis</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true">;</span>\n        <span class="token operator">/</span><span class="token operator">/</span> \u5f53\u524d\u7cfb\u7edf\u65f6\u95f4\u5c0f\u4e8e\u4e0a\u4e00\u6b21\u8bb0\u5f55\u65f6\u95f4\n        <span class="token keyword">if</span> <span class="token punctuation">(</span>now <span class="token operator">&lt;</span> lastTimeStamp<span class="token punctuation">)</span> {\n            throw new <span class="token function">RuntimeException</span><span class="token punctuation">(</span><span class="token string">"\u65f6\u949f\u56de\u62e8\u5f02\u5e38"</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true">;</span>\n        }\n        <span class="token operator">/</span><span class="token operator">/</span> \u76f8\u540c\u65f6\u95f4 \u8981\u5e8f\u5217\u53f7\u8fdb\u5236\u589e\u91cf\n        <span class="token keyword">if</span> <span class="token punctuation">(</span>now <span class="token operator">==</span> lastTimeStamp<span class="token punctuation">)</span> {\n            <span class="token operator">/</span><span class="token operator">/</span> \u9632\u6b62\u6ea2\u51fa\n            sequence <span class="token operator">=</span> <span class="token punctuation">(</span>sequence <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> sequenceMask<span class="token comment" spellcheck="true">;</span>\n            <span class="token keyword">if</span> <span class="token punctuation">(</span>sequence <span class="token operator">==</span> 0L<span class="token punctuation">)</span> {\n                <span class="token operator">/</span><span class="token operator">/</span> \u6ea2\u51fa\u5904\u7406\n                try {\n                    Thread<span class="token punctuation">.</span><span class="token function">sleep</span><span class="token punctuation">(</span>1L<span class="token punctuation">)</span><span class="token comment" spellcheck="true">;</span>\n                } catch <span class="token punctuation">(</span>InterruptedException e<span class="token punctuation">)</span> {\n                    throw new <span class="token function">RuntimeException</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token comment" spellcheck="true">;</span>\n                }\n            }\n            <span class="token operator">/</span><span class="token operator">/</span> \u83b7\u53d6\u4e0b\u4e00\u6beb\u79d2\u65f6\u95f4\uff08\u6709\u9501\uff09\n            now <span class="token operator">=</span> System<span class="token punctuation">.</span><span class="token function">currentTimeMillis</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true">;</span>\n        } <span class="token keyword">else</span> {\n            sequence <span class="token operator">=</span> 0L<span class="token comment" spellcheck="true">;</span>\n        }\n        <span class="token operator">/</span><span class="token operator">/</span> \u8bb0\u5f55\u5f53\u524d\u65f6\u95f4\n        lastTimeStamp <span class="token operator">=</span> now<span class="token comment" spellcheck="true">;</span>\n        <span class="token operator">/</span><span class="token operator">/</span> \u5f53\u524d\u65f6\u95f4\u548c\u8d77\u59cb\u65f6\u95f4\u63d2\u503c \u53f3\u79fb<span class="token number">22</span>\u4f4d\n        long handleTimeStamp <span class="token operator">=</span> <span class="token punctuation">(</span>now <span class="token operator">-</span> startTimeStamp<span class="token punctuation">)</span> <span class="token operator">&lt;</span><span class="token operator">&lt;</span> timeStampIndex<span class="token comment" spellcheck="true">;</span>\n        <span class="token operator">/</span><span class="token operator">/</span> \u6570\u636e\u4e2d\u5fc3\u6570\u503c \u53f3\u79fb<span class="token number">17</span>\u4f4d\uff0c\u6309\u4f4d\u6216\u65f6\u95f4\u6233\u5904\u7406\u540e\u7684\u503c\n        long handleWorkId <span class="token operator">=</span> <span class="token punctuation">(</span>workID <span class="token operator">&lt;</span><span class="token operator">&lt;</span> workIDIndex<span class="token punctuation">)</span> | handleTimeStamp<span class="token comment" spellcheck="true">;</span>\n        <span class="token operator">/</span><span class="token operator">/</span> \u673a\u5668ID\u6570\u503c \u53f3\u79fb<span class="token number">12</span>\u4f4d\uff0c\u6309\u4f4d\u6216\n        long handleDataCenterId <span class="token operator">=</span> <span class="token punctuation">(</span>dataCenterID <span class="token operator">&lt;</span><span class="token operator">&lt;</span> dataCenterIndex<span class="token punctuation">)</span> | handleWorkId<span class="token comment" spellcheck="true">;</span>\n        <span class="token operator">/</span><span class="token operator">/</span> \u5e8f\u5217\u53f7 \u6309\u4f4d\u6216\n        long ID <span class="token operator">=</span> handleDataCenterId | sequence<span class="token comment" spellcheck="true">;</span>\n        return ID<span class="token comment" spellcheck="true">;</span>\n    }\n\n}'},["code",'public class SnowFlakeUtil {\n    // \u8d77\u59cb\u65f6\u95f4\u6233\n    private static long startTimeStamp;\n    // \u673a\u5668ID\n    private static long workID;\n    // \u6570\u636e\u4e2d\u5fc3ID\n    private static long dataCenterID;\n    // \u5e8f\u5217\u53f7\n    private static long sequence;\n    // \u6570\u636e\u4e2d\u5fc3ID\u79fb\u52a8\u4f4d\u6570\n    private static long dataCenterIndex;\n    // \u673a\u5668ID\u79fb\u52a8\u4f4d\u6570\n    private static long workIDIndex;\n    // \u65f6\u95f4\u6233\u79fb\u52a8\u4f4d\u6570\n    private static long timeStampIndex;\n    // \u8bb0\u5f55\u4e0a\u4e00\u6b21\u65f6\u95f4\u6233\n    private static long lastTimeStamp;\n    // \u5e8f\u5217\u53f7\u63a9\u7801\n    private static long sequenceMask;\n    // \u5e8f\u5217\u53f7\u957f\u5ea612\u4f4d\n    private static long sequenceLength;\n\n    // \u521d\u59cb\u5316\u6570\u636e\n    static {\n        startTimeStamp = 1577808000000L;\n        // \u8bbe\u7f6e\u673a\u5668\u7f16\u53f7 1\n        workID = 1L;\n        // \u8bbe\u7f6e\u6570\u636e\u4e2d\u5fc3ID\n        dataCenterID = 1L;\n        // \u8d77\u59cb\u5e8f\u5217\u53f7 0\u5f00\u59cb\n        sequence = 0L;\n        // \u6570\u636e\u4e2d\u5fc3\u4f4d\u79fb\u4f4d\u6570\n        dataCenterIndex = 12L;\n        // \u673a\u5668ID\u4f4d\u79fb\u4f4d\u6570\n        workIDIndex = 17L;\n        // \u65f6\u95f4\u6233\u4f4d\u79fb\u4f4d\u6570\n        timeStampIndex = 22L;\n        // \u8bb0\u5f55\u4e0a\u6b21\u65f6\u95f4\u6233\n        lastTimeStamp = -1L;\n        // \u5e8f\u5217\u53f7\u957f\u5ea6\n        sequenceLength = 12L;\n        // \u5e8f\u5217\u53f7\u63a9\u7801\n        sequenceMask = -1L ^ (-1L << sequenceLength);\n    }\n\n    public synchronized static long getID() {\n        // \u83b7\u5f97\u5f53\u524d\u65f6\u95f4\n        long now = System.currentTimeMillis();\n        // \u5f53\u524d\u7cfb\u7edf\u65f6\u95f4\u5c0f\u4e8e\u4e0a\u4e00\u6b21\u8bb0\u5f55\u65f6\u95f4\n        if (now < lastTimeStamp) {\n            throw new RuntimeException("\u65f6\u949f\u56de\u62e8\u5f02\u5e38");\n        }\n        // \u76f8\u540c\u65f6\u95f4 \u8981\u5e8f\u5217\u53f7\u8fdb\u5236\u589e\u91cf\n        if (now == lastTimeStamp) {\n            // \u9632\u6b62\u6ea2\u51fa\n            sequence = (sequence + 1) & sequenceMask;\n            if (sequence == 0L) {\n                // \u6ea2\u51fa\u5904\u7406\n                try {\n                    Thread.sleep(1L);\n                } catch (InterruptedException e) {\n                    throw new RuntimeException(e);\n                }\n            }\n            // \u83b7\u53d6\u4e0b\u4e00\u6beb\u79d2\u65f6\u95f4\uff08\u6709\u9501\uff09\n            now = System.currentTimeMillis();\n        } else {\n            sequence = 0L;\n        }\n        // \u8bb0\u5f55\u5f53\u524d\u65f6\u95f4\n        lastTimeStamp = now;\n        // \u5f53\u524d\u65f6\u95f4\u548c\u8d77\u59cb\u65f6\u95f4\u63d2\u503c \u53f3\u79fb22\u4f4d\n        long handleTimeStamp = (now - startTimeStamp) << timeStampIndex;\n        // \u6570\u636e\u4e2d\u5fc3\u6570\u503c \u53f3\u79fb17\u4f4d\uff0c\u6309\u4f4d\u6216\u65f6\u95f4\u6233\u5904\u7406\u540e\u7684\u503c\n        long handleWorkId = (workID << workIDIndex) | handleTimeStamp;\n        // \u673a\u5668ID\u6570\u503c \u53f3\u79fb12\u4f4d\uff0c\u6309\u4f4d\u6216\n        long handleDataCenterId = (dataCenterID << dataCenterIndex) | handleWorkId;\n        // \u5e8f\u5217\u53f7 \u6309\u4f4d\u6216\n        long ID = handleDataCenterId | sequence;\n        return ID;\n    }\n\n}']]],meta:{filename:"posts/draft/java\u540e\u7aef/999.tips/2.id\u751f\u6210\u7b56\u7565.md"}}}});